C51 COMPILER V9.01   MAIN                                                                  08/21/2016 14:08:13 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c COMPACT DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg51.h>
   2          #include "delay.h"
   3          #include "LCD1602.h"
   4          #include "I2C.h"
   5          #include "EEPROM.h"
   6          #include "NRF2401.h"
   7          //#define GPIO_KEY P1
   8          #define DIG_GPIO_DUAN P1
   9          #define DIG_GPIO_WEI P0
  10          sbit LSA=P2^2;
  11          sbit LSB=P2^3;
  12          sbit LSC=P2^4;
  13          sbit NRF_IR  = P3^5;
  14          
  15          unsigned char rece_buf[32];
  16          unsigned char code DIG_PLACE[8]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};//‰ΩçÈÄâÊéßÂà∂   Êü•Ë°®ÁöÑÊñπÊ≥ï
             -ÊéßÂà∂
  17          unsigned char code DIG_CODE[17]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x7
             -9,0x71};  //0~FÁöÑÊòæÁ§∫Á†Å
  18          
  19          
  20          int main(void)
  21          {
  22   1        unsigned char count,i,flag_4=1; //flag_4ËØªÂèñÊ†áÂøó‰ΩçÔºåÈÅøÂÖçÈáçÂ§çËØªÂèñ
  23   1      //  unsigned char rece_buf[32]="8>52103876cADf857";
  24   1        LCD1602_Init();// LCDÂàùÂßãÂåñ
  25   1        while(NRF24L01_Check()); // Á≠âÂæÖÊ£ÄÊµãÂà∞NRF24L01ÔºåÁ®ãÂ∫èÊâç‰ºöÂêë‰∏ãÊâßË°å
  26   1        NRF24L01_RT_Init();
  27   1        while(1)
  28   1        {
  29   2          if(NRF_IR==0)   // Â¶ÇÊûúÊó†Á∫øÊ®°ÂùóÊé•Êî∂Âà∞Êï∞ÊçÆ
  30   2          {
  31   3            if(NRF24L01_RxPacket(rece_buf)==0)
  32   3            {
  33   4              if(rece_buf[1]!='>')
  34   4              {
  35   5                sendstring("Please start with >\n");
  36   5              }
  37   4              else
  38   4              {
  39   5                if(rece_buf[2]!='5'&&\
  40   5                rece_buf[3]!='2'&&\
  41   5                rece_buf[4]!='1'&&\
  42   5                rece_buf[5]!='0'
  43   5                )return -1;
  44   5                else
  45   5                {
  46   6                  switch (rece_buf[6])
  47   6                   {
  48   7                    case '1':   //ÊòæÁ§∫ÂèëÈÄÅÊï∞ÊçÆÂπ∂ÊääÊï∞ÊçÆ‰øùÂ≠òÂà∞EEPROMÈáåÈù¢
  49   7                              sendstring("display and save data\n");
  50   7                              LCD1602_Writecom(0X01);
  51   7                              LCD1602_Writestring("Write:");
  52   7                              LCD1602_Writestring(rece_buf+7);//‰ªéÁ¨¨‰∏É‰ΩçÂºÄÂßãÊòæÁ§∫Êï∞ÊçÆ,ÊääÁ¨¨‰∏É‰ΩçÁöÑÂú
             -∞ÂùÄ‰º†ÁªôÊåáÈíà
C51 COMPILER V9.01   MAIN                                                                  08/21/2016 14:08:13 PAGE 2   

  53   7                              AT24C02_writestring(rece_buf+7);//‰ªéÁ¨¨‰∏É‰ΩçÂºÄÂßã‰øùÂ≠òÊï∞ÊçÆ,ÊääÁ¨¨‰∏É‰ΩçÁöÑÂú
             -∞ÂùÄ‰º†ÁªôÊåáÈíà
  54   7                              flag_4=1;
  55   7                              break;
  56   7                    case '2':  //Â±èÂπïÂ∑¶Áßª
  57   7                              sendstring("move left\n");
  58   7                            //  LCD1602_Writestring(rece_buf+7);//‰ªéÁ¨¨‰∏É‰ΩçÂºÄÂßãÊòæÁ§∫Êï∞ÊçÆ,ÊääÁ¨¨‰∏É‰ΩçÁöÑ
             -Âú∞ÂùÄ‰º†ÁªôÊåáÈíà
  59   7                              for(count=0;count<14;count++)
  60   7                              {
  61   8                                LCD1602_Writecom(0X18);//Êï¥Â±èÂ∑¶Áßª
  62   8                                Delay_100ms();
  63   8                              }
  64   7                              break;
  65   7                    case '3'://Áî®Êï∞Á†ÅÁÆ°ÊòæÁ§∫Êï∞ÊçÆ
  66   7                              sendstring("Display on the digital_control\n");
  67   7                              LCD1602_Writecom(0X01);
  68   7                              LCD1602_Writestring("Display on the ");
  69   7                              LCD1602_Writecom(0x80+0x40);
  70   7                              LCD1602_Writestring("digital_control");
  71   7                              while (rece_buf[6]=='3')
  72   7                              {
  73   8                                NRF24L01_RxPacket(rece_buf);
  74   8                                for(count=0;count<8;count++)
  75   8                                {
  76   9                                  switch(count)  //‰ΩçÈÄâÔºåÈÄâÊã©ÁÇπ‰∫ÆÁöÑÊï∞Á†ÅÁÆ°Ôºå
  77   9                                  {
  78  10                                    case(0):
  79  10                                    LSA=0;LSB=0;LSC=0; break;//ÊòæÁ§∫Á¨¨0‰Ωç
  80  10                                    case(1):
  81  10                                    LSA=1;LSB=0;LSC=0; break;//ÊòæÁ§∫Á¨¨1‰Ωç
  82  10                                    case(2):
  83  10                                    LSA=0;LSB=1;LSC=0; break;//ÊòæÁ§∫Á¨¨2‰Ωç
  84  10                                    case(3):
  85  10                                    LSA=1;LSB=1;LSC=0; break;//ÊòæÁ§∫Á¨¨3‰Ωç
  86  10                                    case(4):
  87  10                                    LSA=0;LSB=0;LSC=1; break;//ÊòæÁ§∫Á¨¨4‰Ωç
  88  10                                    case(5):
  89  10                                    LSA=1;LSB=0;LSC=1; break;//ÊòæÁ§∫Á¨¨5‰Ωç
  90  10                                    case(6):
  91  10                                    LSA=0;LSB=1;LSC=1; break;//ÊòæÁ§∫Á¨¨6‰Ωç
  92  10                                    case(7):
  93  10                                    LSA=1;LSB=1;LSC=1; break;//ÊòæÁ§∫Á¨¨7‰Ωç
  94  10                                  }
  95   9                                  if(rece_buf[count+7]<='9')
  96   9                                  DIG_GPIO_DUAN=DIG_CODE[rece_buf[count+7]-'0'];
  97   9                                  else if(rece_buf[count+7]<='f'&&rece_buf[count+7]>='a')
  98   9                                  DIG_GPIO_DUAN=DIG_CODE[rece_buf[count+7]-'a'+10];
  99   9                                  else if(rece_buf[count+7]<='F'&&rece_buf[count+7]>='A')
 100   9                                  DIG_GPIO_DUAN=DIG_CODE[rece_buf[count+7]-'A'+10];
 101   9                                  i=500;  //Ê∂àÊäñ
 102   9                                  while(i--);
 103   9                                }
 104   8                              }
 105   7                              break;
 106   7                    case '4'://‰ªéEEPROM‰∏≠ËØªÂèñÊï∞ÊçÆÔºåÂπ∂Áî®LCD1602ÊòæÁ§∫Âá∫Êù•
 107   7                              sendstring("display and read from EEPROM\n");
 108   7                              LCD1602_Writecom(0X01);
 109   7                              LCD1602_Writestring("Read:");
 110   7                              for(count=0;rece_buf[count+7]!='\0';count++)
 111   7                              {
 112   8                                LCD1602_Writedata(AT24C02_read(count));
C51 COMPILER V9.01   MAIN                                                                  08/21/2016 14:08:13 PAGE 3   

 113   8                              }
 114   7                              flag_4=0;
 115   7                              break;
 116   7                    default :
 117   7                              sendstring("The fifth number error (0-4)\n");
 118   7                              break;
 119   7                  }
 120   6                }
 121   5              }
 122   4             }
 123   3           }
 124   2         }
 125   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    484    ----
   CONSTANT SIZE    =    217    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =     32       2
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
